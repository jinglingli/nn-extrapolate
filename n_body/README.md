# Rrepresentations that help extrapolation

We show **improved representations** help extrapolation on the n-body physical reasoning problem.

The n-body problem asks a neural network to predict how n stars in a physical system evolves according to physics laws. That is, we train neural networks to predict properties of future states of each star in terms of next frames, e.g., 0.001 seconds.

## Data Generation
We sample 100 videos of 3-body system evolution, each with 500 rollout, i.e., time steps. We consider the orbit situation: there exists a huge center star and several other stars. Feel free to refer to appendix C.7 for more of our dataset details.

We consider two extrapolation scenarios (distance or  mass):
- The test set contains objects with out-of-distribution distances, which is generated by the command
```
python physics.py --ext=mass --center_ratio=2 --obj_ratio=2 --data=n_body_extrapolate_mass
```

- The test set contains objects with out-of-distribution masses, which is generated by the command
```
python physics.py --ext=dist --data=n_body_extrapolate_distance
```

The interpolation scenario is generated by the command
```
python physics.py --ext=None --data=n_body_interpolate
```

The argument of the `--data` flag sets the name for the generated pickle files, which will be under the `data` folder by default. Refer to [`physics.py`](./physics.py) for more data generation options.

## Training
To train on the generated dataset, just feed the dataset name to the `--data` flag. The `--fe` flag controls whether we want to add feature engineering to the edge features of the input graphs. For example,
```
CUDA_VISBILE_DEVICES=0 python main.py --data=n_body_extrapolate_mass --fe
```
trains a GNN on `n_body_extrapolate_mass.pickle` with feature-engineered input representations.

And 

```
CUDA_VISBILE_DEVICES=0 python main.py --data=n_body_extrapolate_mass 
```
trains a GNN on `n_body_extrapolate_mass.pickle` with normal input representations. 


The training logs will be under the `results` folder.

## Reproducing results in the paper
We also include a script file [`reproduce.sh`](./reproduce.sh) to repoduce the results on extrapolation settings for the n-body experiments. To be more specific,
```
bash ./reproduce.sh
```
reproduces the results with feature-engineered input representations (pink bars) in Figure 6(b).
